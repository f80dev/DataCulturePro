<div style="margin:1%;text-align: center;min-width: 300px;">

  <app-tuto icon_button="login"
            [if]="!config.user?.email"
            (click)="router.navigate(['login'])"
            label="Connectez vous pour avoir accès à plus d'information sur les profils">
  </app-tuto>

  <app-tuto [delay]="10"
            id="tutoSideMenu"
            label="Vous pouvez également consulter la liste des réalisations de la FEMIS, via le menu latéral"></app-tuto>


  <mat-form-field *ngIf="advanced_search?.length==0" appearance="legacy"
                  style="max-width:600px;width:60%;font-size: x-large;display: inline-block;margin:5px;" autofocus>
    <mat-label><mat-icon>person_search</mat-icon>&nbsp;Recherche</mat-label>
    <input matInput matNativeControl
           id="txtSearch"
           title="Un ou plusieurs mots pour effectuer des recherches dans les métiers, les noms, les réalisations ..."
           (keyup)="onQuery($event)"
           placeholder="nom, métier, promotion ou titre d'une réalisation"
           [(ngModel)]="query.value">
    <div matSuffix style="font-size: medium;display: inline-block;">
      <mat-icon *ngIf="query.value?.length>0"
                matSuffix style="cursor: pointer;color:lightgray;"
                id="cmdCancel"
                (click)="clearQuery()">cancel</mat-icon>
      <mat-icon *ngIf="query.value?.length==0"
                matSuffix style="cursor: pointer;color:lightgray;"
                id="cmdHelp"
                (click)="help()">help</mat-icon>
      <mat-icon *ngIf="advanced_search?.length==0"
                matSuffix style="cursor: pointer;color:lightgray;margin-left:3px;"
                id="cmdExpertMode"
                (click)="switch_motor()">add_circle</mat-icon>

    </div>

  </mat-form-field>

  <div *ngIf="advanced_search?.length>0" style="display: inline-block">
    <div *ngFor="let i of advanced_search" style="display: inline-block">
      <mat-form-field [ngStyle]="{width:i.width}" style="margin: 3px;">
        <mat-label>{{i.label}}</mat-label>
        <input matInput matNativeControl
               [title]="i.title"
               [id]="i.id"
               (keyup)="onQuery($event)"
               placeholder=""
               [(ngModel)]="i.value">
      </mat-form-field>

    </div>

  </div>


  <!--  <mat-form-field appearance="fill" class="app-field" style="width:15%;max-width:80 px;margin-right:3%;">-->
  <!--          <mat-label>Genre</mat-label>-->
  <!--          <mat-select name="gender" [(ngModel)]="profil.gender">-->
  <!--            <mat-option value="F">Mme</mat-option>-->
  <!--            <mat-option value="H">M</mat-option>-->
  <!--          </mat-select>-->
  <!--        </mat-form-field>-->

  <div *ngIf="profils?.length>3 && advanced_search?.length>0"
       style="display: inline-block;text-align: right;margin:5px;" autofocus>

    <mat-form-field appearance="legacy"
                    *ngIf="config.width_screen>400"
                    style="max-width:150px;font-size: small;">
      <mat-label>Trier par</mat-label>
      <mat-select id="selOrder" [(ngModel)]="order" (selectionChange)="refresh()">
        <mat-option *ngFor="let f of fields" [value]="f.value">{{f.field}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-icon style="font-size: large;cursor: pointer;"
              (click)="change_order()" *ngIf="config.width_screen<=400">
      sort
    </mat-icon>

  </div>
   <mat-icon *ngIf="advanced_search?.length>0"
      matSuffix style="cursor: pointer;color:lightgray;margin-left:3px;"
      id="cmdSimpleMode"
      (click)="switch_motor()">remove_circle</mat-icon>

  <br>


  <!--Toolbar de recherche avancée -->
  <div style="font-size: small" *ngIf="profils?.length>3 && advanced_search?.length>0" >
    <div *ngIf="profils.length>8" style="display: inline-block;margin:5px;" title="Recherche avancée: notamment des recherches sur une partie du nom, du prenom en utilisant des *">
      <span *ngIf="profils.length==this.limit">+ de </span>
      {{profils.length}} profils
      <mat-icon style="cursor: pointer;font-size: medium;" (click)="inc_limit()">
        add_circle
      </mat-icon>
    </div>
    &nbsp;
    <mat-checkbox id="chkPro" [(ngModel)]="filter_with_pro"
                  title="Ajouter la formation professionnelle aux résultats"
                  (change)="with_pro($event)" labelPosition="Before">
      <div style="line-height: 85%;text-align: left;">Formation<br>professionnelle</div>
    </mat-checkbox>
  </div>

</div>


<div class="div-center">
  <app-hourglass [message]="message"></app-hourglass>
</div>

<span *ngIf="profils?.length==0 && message.length==0 && (query.value?.length>0 || this.advanced_search?.length>0)">
  Aucun profil ne correspond à cette recherche
</span>



<!-- Affichage des profils-->
<div class="wrap-list" *ngIf="message.length==0 && config.ready">
  <!--  <cdk-virtual-scroll-viewport [itemSize]="50">-->
  <app-profil
    name="profils" class="app-card"
    *ngFor="let profil of profils"
    (delete)="deleteProfil(profil)"
    [backgroundColor]="profil.backgroundColor"
    [writeAccess]="config.user && config.user.profil==profil?.id || config.hasPerm('edit_profil')"
    (askfriend)="askfriend(profil)"
    (onclick)="openQuery($event)"
    [profil]="profil">
  </app-profil>
  <!--  </cdk-virtual-scroll-viewport>-->
</div>



